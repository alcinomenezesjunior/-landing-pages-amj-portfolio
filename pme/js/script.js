function getDeviceType(){let e=navigator.userAgent;return/Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile/i.test(e)?"mobile":"desktop"}function adjustContentForFixedHeader(){let e=document.querySelector(".header"),t=document.querySelector("section.hero");if(e&&t){let r=e.offsetHeight;t.style.paddingTop=`${r+20}px`}}function debounce(e,t){let r;return function o(...n){let a=()=>{clearTimeout(r),e(...n)};clearTimeout(r),r=setTimeout(a,t)}}function initSmoothScrolling(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();let t=this.getAttribute("href"),r=document.querySelector(t);if(r){let o=document.querySelector(".header"),n=o?o.offsetHeight:60,a=r.offsetTop-n-20;window.scrollTo({top:a,behavior:"smooth"})}})})}function initHeaderScroll(){let e=document.querySelector(".header");e&&window.addEventListener("scroll",()=>{window.scrollY>100?(e.style.background="rgba(255, 255, 255, 0.98)",e.style.boxShadow="0 4px 20px rgba(0, 0, 0, 0.1)"):(e.style.background="rgba(255, 255, 255, 0.95)",e.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.1)")})}function initScrollAnimations(){let e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.style.opacity="1",e.target.style.transform="translateY(0)")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});document.querySelectorAll(".challenge-card, .solution-card, .certificate-item, .process-step").forEach(t=>{t.style.opacity="0",t.style.transform="translateY(30px)",t.style.transition="opacity 0.6s ease-out, transform 0.6s ease-out",e.observe(t)})}function initPhoneFlag(){let e=document.getElementById("whatsapp_ddi"),t=document.getElementById("phone-flag");if(!e||!t)return;let r=()=>{try{let r=e.options[e.selectedIndex],o=r.getAttribute("data-country");o?t.style.backgroundImage=`url('https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/7.2.1/flags/4x3/${o}.svg')`:t.style.backgroundImage="none"}catch(n){console.error("Erro ao atualizar a bandeira: ",n)}};r(),e.addEventListener("change",r)}function validateForm(){let e=!0,t=document.getElementById("leadForm");t.querySelectorAll(".error-message").forEach(e=>e.textContent=""),t.querySelectorAll("input, select, .phone-group-container").forEach(e=>{e.style.borderColor="var(--bg-tertiary)"}),document.querySelector(".consent-checkbox").style.outline="none",["nome","empresa","selo","whatsapp_ddi","whatsapp_num"].forEach(t=>{let r=document.getElementById(t);r&&!r.value.trim()&&(r.style.borderColor="var(--danger-color)",e=!1)});let r=document.getElementById("email");r&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.value)&&(r.style.borderColor="var(--danger-color)",document.getElementById("email-error").textContent="Por favor, insira um e-mail v\xe1lido.",e=!1);let o=document.getElementById("whatsapp_num"),n=document.getElementById("whatsapp-error");if(o){let a=o.value.replace(/\D/g,"");(a.length<7||a.length>15)&&(document.querySelector(".phone-group-container").style.borderColor="var(--danger-color)",n&&(n.textContent="Por favor, insira um n\xfamero de telem\xf3vel v\xe1lido."),e=!1)}let i=document.getElementById("consent");return i&&!i.checked&&(document.querySelector(".consent-checkbox").style.outline="2px solid var(--danger-color)",e=!1),e}function trackConversion(e){"function"==typeof window.gtag&&window.gtag("event","form_submit",{event_category:"Lead",event_label:"PME Consultoria"}),"function"==typeof window.fbq&&window.fbq("track","Lead")}function showTemporaryMessage(e,t=!0){let r=document.querySelector(".temporary-message-container");r&&r.remove();let o=document.createElement("div");o.className="temporary-message-container",o.style.cssText=`
        position: fixed; top: 20px; right: 20px; z-index: 9999;
        background: ${t?"var(--danger-color)":"var(--success-color)"};
        color: white; padding: 1rem; border-radius: 8px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.2); display: flex;
        align-items: center; gap: 1rem;
    `;let n=`<i class="${t?"ri-close-circle-line":"ri-check-circle-line"}"></i> <div>${e}</div>`,a=document.createElement("button");a.innerHTML="&times;",a.style.cssText="background:none; border:none; color:white; font-size:1.5rem; cursor:pointer; margin-left:1rem;",a.onclick=()=>o.remove(),o.innerHTML=n,o.appendChild(a),document.body.appendChild(o)}function initFormSubmission(){let e=document.getElementById("leadForm"),t=document.getElementById("submitBtn");e&&t&&(t.addEventListener("click",function(r){r.preventDefault(),t.disabled=!0,t.innerHTML='<i class="ri-loader-4-line ri-spin"></i> A Enviar...',setTimeout(()=>{if(validateForm()){let r=new FormData(e),o=Object.fromEntries(r.entries());o.whatsapp=(o.whatsapp_ddi||"")+" "+(o.whatsapp_num||""),delete o.whatsapp_ddi,delete o.whatsapp_num,o.deviceType=getDeviceType();try{let n=new UAParser;o.browserName=n.getBrowser().name||"N/A",o.osName=n.getOS().name||"N/A"}catch(a){}fetch("processa-lead.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).catch(e=>console.error("Falha ao contactar o servidor:",e)),trackConversion(o);let i=o.selo;if("pme-lider"===i||"pme-excelencia"===i||"candidato"===i){let l="obrigado-form.html",s=encodeURIComponent(o.nome||""),c=encodeURIComponent(o.email||""),d=encodeURIComponent(o.whatsapp||"");l+=`?name=${s}&email=${c}&phone=${d}`,window.location.href=l}else window.location.href="agradecimento-form.html"}else{t.disabled=!1,t.innerHTML='<i class="ri-calendar-check-line"></i> Agendar Consultoria Estrat\xe9gica Exclusiva';let p=e.querySelector('[style*="var(--danger-color)"]');p&&p.focus()}},150)}),e.addEventListener("submit",function(e){e.preventDefault(),t.click()}))}function initializePage(){adjustContentForFixedHeader(),initSmoothScrolling(),initHeaderScroll(),initScrollAnimations(),initFormSubmission(),initPhoneFlag()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initializePage):initializePage(),window.addEventListener("resize",debounce(adjustContentForFixedHeader,100));
